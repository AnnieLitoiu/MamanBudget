{% extends 'base.html.twig' %}

{% block title %}Semaine {{ partie.semaineCourante }} | MamanSolo{% endblock %}

{% block body %}
<section class="container" style="max-width: 800px; margin-top: 2rem;">

  <h1 class="mb-3">
    Semaine {{ partie.semaineCourante }} / {{ partie.nbSemaines }}
  </h1>

  <div class="mb-3">
    <p><strong>Budget courant :</strong> {{ partie.budgetCourant }} €</p>
    <p><strong>Bonheur :</strong> {{ partie.bonheurCourant }}</p>
  </div>

  {% for message in app.flashes('error') %}
    <div class="alert alert-danger">{{ message }}</div>
  {% endfor %}

  {% if partie.etat == 'TERMINE' %}
    <div class="alert alert-info">
      La partie est terminée.
      <a href="{{ path('game_summary', { id: partie.id }) }}">Voir le résumé final</a>.
    </div>
  {% else %}
    {% if evenement %}
      <div class="card mb-4">
        <div class="card-body">
          <h2 class="h5 mb-3">Événement de la semaine</h2>
          <p>{{ evenement.texte }}</p>

          {% if evenement.options is not empty %}
            <h3 class="h6 mt-4">Que fais-tu ?</h3>

            <form method="post" action="{{ path('game_play', { id: partie.id }) }}">
              {% for option in evenement.options %}
                <button
                  type="submit"
                  name="optionId"
                  value="{{ option.id }}"
                  class="btn btn-primary d-block w-100 text-start mb-2"
                >
                  {{ option.libelle }}
                </button>
              {% endfor %}
            </form>
          {% else %}
            <p class="text-muted mt-3">Aucune option disponible pour cet événement.</p>
          {% endif %}
        </div>
      </div>
    {% else %}
      <p class="alert alert-warning">
        Aucun événement disponible pour cette semaine.</p>
    {% endif %}
  {% endif %}

  <a href="{{ path('app_menu') }}" class="btn btn-link mt-3">Retour au menu</a>
</section>
{% endblock %}
